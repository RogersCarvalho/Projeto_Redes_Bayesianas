import pandas as pd

data = pd.read_csv('base_nell_novo.csv', encoding = 'UTF-8', sep="\t", usecols=['Entity','Relation','Value'])
data.shape

data = data[data.Relation != "generalizations"]
data.shape

data=data[data['Entity'].str.contains("disease") | data['Value'].str.contains("disease")]
data.shape

data = data.sort_values(['Entity','Relation','Value'])

data=data[
   
    (data['Relation'].str.contains("inverseofbacteriaisthecausativeagentofphysiologicalcondition")) |
    (data['Relation'].str.contains("inverseoffooddecreasestheriskofdisease"))  |
    (data['Relation'].str.contains("inverseoffoodcancausedisease")) |
    (data['Relation'].str.contains("inverseofbeveragecansoftendisease")) |
    (data['Relation'].str.contains("sideeffectcausedbydrug")) |
    (data['Relation'].str.contains("physiologicalconditionpossiblytreatedbydrug")) |
    (data['Relation'].str.contains("inverseofdiseasecausesphysiologicalcondition")) |
    (data['Relation'].str.contains("physiologicalconditionstudedbyperson"))  | 
    (data['Relation'].str.contains("bodypartwithinbodypart")) | 
    (data['Relation'].str.contains("inverseofemotionassocietedwithdisease")) | 
    (data['Relation'].str.contains("inverseofanimaldevelopdisease")) 
    (data['Relation'].str.contains("drughassideeffect")) |
    (data['Relation'].str.contains("drugworkedonbyagent")) |
    (data['Relation'].str.contains("agriculturalproductcontainchemical")) |
    (data['Relation'].str.contains("beveragecontainsprotein")) |
    (data['Relation'].str.contains("bacteriacancauseillnessfromfood"))  
]    

data
#data=data[0:50]

#valores=[1,2,3,4,...3385]
valores = []
#n=1
for item in range(1,21):
    valores.append(item)
nova_coluna = valores
#print(nova_coluna)
#nova_coluna=[1,2,3,4,...3385]

data.insert(loc=0, column= 'Mat', value= nova_coluna)
#data

data = data.sort_values(['Relation'])
data=data.set_index(['Mat','Entity','Relation'],drop=True).unstack('Relation')
data

data.to_csv('relacoes_disease_coluna_nomerelacao.csv')


